(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16579,        370]
NotebookOptionsPosition[     15687,        347]
NotebookOutlinePosition[     16085,        363]
CellTagsIndexPosition[     16042,        360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"<<", 
    RowBox[{
    "(", "\"\</Users/oliver/Desktop/projects/darkmatter/sample/dmformfactor-\
temp.m\>\"", ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Centimeter", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["10", "13"], " ", "Femtometer"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keV", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]], " ", "GeV"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mNuc", "=", 
   RowBox[{"0.93827", "*", "GeV"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", "=", 
   RowBox[{"220", "KilometerPerSecond"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ve", "=", 
   RowBox[{"232", "KilometerPerSecond"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhoDM", " ", "=", " ", 
    RowBox[{"0.3", " ", 
     RowBox[{"GeV", "/", 
      SuperscriptBox["Centimeter", "3"]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "=", "14"}], ";", " ", 
  RowBox[{"m", "=", "28"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetIsotope", "[", 
   RowBox[{"z", ",", "m", ",", "\"\<default\>\"", ",", "\"\<default\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mTarget", " ", "=", " ", 
   RowBox[{"mNuc", " ", "*", " ", "m"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NT", "=", 
    RowBox[{"1", "/", 
     RowBox[{"(", "mTarget", ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetJChi", "[", 
   RowBox[{"1", "/", "2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetMChi", "[", 
   RowBox[{"1500", " ", "GeV"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"1", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"3", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"4", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"5", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"6", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"7", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"8", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"9", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"10", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"11", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"12", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"13", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"14", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetCoeffsNonrel", "[", 
    RowBox[{"15", ",", " ", "1.", ",", "\"\<p\>\""}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetHALO", "[", "\"\<MB\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ekev", " ", "=", "100.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"2500", "*", "KilogramDay", " ", "*", " ", 
   RowBox[{"EventRate", "[", 
    RowBox[{"NT", ",", "rhoDM", ",", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "*", 
        RowBox[{"mTarget", "/", "GeV"}], "*", "Ekev", "*", 
        RowBox[{"keV", "/", "GeV"}]}], ")"}], 
      RowBox[{"1", "/", "2"}]], ",", "ve", ",", "v0"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"myrate", "[", "qGeV_", "]"}], "=", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"2500", "*", "KilogramDay"}], ")"}], " ", 
      RowBox[{"EventRate", "[", 
       RowBox[{
       "NT", ",", "rhoDM", ",", "qGeV", ",", "ve", ",", "v0", ",", "vesc"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"myrate", "[", "qGeV", "]"}], " ", "GeV", "*", 
        RowBox[{"(", 
         RowBox[{"qGeV", " ", 
          RowBox[{"GeV", "/", 
           RowBox[{"(", "mTarget", ")"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"qGeV", ",", "0", ",", "10"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"A", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Ekev", ",", 
            RowBox[{"GeV", "*", "KilogramDay", " ", "*", " ", 
             RowBox[{"EventRate", "[", 
              RowBox[{"NT", ",", "rhoDM", ",", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"2", "*", 
                  RowBox[{"mTarget", "/", "GeV"}], "*", "Ekev", "*", 
                  RowBox[{"keV", "/", "GeV"}]}], ")"}], 
                RowBox[{"1", "/", "2"}]], ",", "ve", ",", "v0"}], "]"}]}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Ekev", ",", "0.1", ",", "1000", ",", "10"}], "}"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
     
     RowBox[{"Print", "[", "A", "]"}], "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
      "\"\</Users/oliver/Desktop/projects/darkmatter/sample/test.si28.dat\>\"\
", ",", "A"}], "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.793490410067214*^9, 3.793490416320354*^9}, {
   3.793490601240102*^9, 3.7934906081070747`*^9}, {3.794183367590694*^9, 
   3.794183367706806*^9}, 3.79478124874539*^9, {3.7947813324086018`*^9, 
   3.794781338405695*^9}, {3.7953820336283407`*^9, 3.795382040136541*^9}, {
   3.795382741095727*^9, 3.7953827424648848`*^9}, {3.795382787804698*^9, 
   3.7953827879648657`*^9}, {3.795383161358199*^9, 3.7953831960618143`*^9}, {
   3.795383236975806*^9, 3.795383248308873*^9}, {3.7953849650724697`*^9, 
   3.795384971498005*^9}, {3.795387795395919*^9, 3.7953878232204533`*^9}, {
   3.7953878770685873`*^9, 3.79538788279907*^9}, {3.797189974839698*^9, 
   3.7971899749830437`*^9}, {3.797190058387877*^9, 3.7971900595172157`*^9}, {
   3.797190279376642*^9, 3.797190279432508*^9}, {3.797190440286759*^9, 
   3.797190522108032*^9}, {3.7971906976265163`*^9, 3.7971906998437433`*^9}, {
   3.7971907829972143`*^9, 3.7971907837306767`*^9}, {3.7979524030301113`*^9, 
   3.797952523340369*^9}, {3.797952564400098*^9, 3.7979525646207657`*^9}, {
   3.797952643478393*^9, 3.797952669200509*^9}, {3.797952976537588*^9, 
   3.797952978183794*^9}, {3.797955095802773*^9, 3.797955124894256*^9}, {
   3.797960965056282*^9, 3.79796096518362*^9}, {3.797962110404883*^9, 
   3.7979621194607477`*^9}, {3.798669377172854*^9, 3.7986693850683517`*^9}, {
   3.798669416570314*^9, 3.7986694220119658`*^9}, 3.798669461458296*^9, {
   3.798670905841943*^9, 3.7986709145634403`*^9}, {3.7989352664772377`*^9, 
   3.7989352790158367`*^9}, {3.798935633675097*^9, 3.7989356346802588`*^9}, {
   3.7989364398921556`*^9, 3.7989364401183023`*^9}, {3.79893699859452*^9, 
   3.798937018073009*^9}, {3.7989380247210093`*^9, 3.798938024964447*^9}, {
   3.798938099289225*^9, 3.79893811637171*^9}, {3.79893838594735*^9, 
   3.798938386625798*^9}, {3.7989407302091208`*^9, 3.798940731428252*^9}, {
   3.798991560074741*^9, 3.798991563826208*^9}, {3.798991856971097*^9, 
   3.79899185914869*^9}, {3.79899202402815*^9, 3.798992041855124*^9}, {
   3.798992107922368*^9, 3.7989921232298613`*^9}, {3.7989922549481773`*^9, 
   3.798992255365807*^9}, 3.798992498085147*^9, {3.7990079132367573`*^9, 
   3.799007915722193*^9}, {3.7990079794354*^9, 3.799008001241795*^9}, {
   3.799008052369609*^9, 3.799008054856303*^9}, {3.799008141659869*^9, 
   3.7990081448265343`*^9}, {3.799008441765174*^9, 3.7990084519529*^9}, 
   3.799011121038231*^9, {3.799011227027068*^9, 3.799011234488392*^9}, {
   3.79902405011126*^9, 3.799024052206958*^9}, {3.7990241419779987`*^9, 
   3.799024172049665*^9}, {3.7990243952950907`*^9, 3.799024429350996*^9}, {
   3.799024692538885*^9, 3.799024695131917*^9}, {3.799024758644464*^9, 
   3.7990247587202168`*^9}, {3.7990255882307453`*^9, 3.799025590768423*^9}, {
   3.799025716289378*^9, 3.799025716923978*^9}, {3.799169329819613*^9, 
   3.799169332251799*^9}, {3.799172217703122*^9, 3.799172220128579*^9}, {
   3.799592659637047*^9, 3.799592685040333*^9}, {3.79959298839711*^9, 
   3.7995930186994267`*^9}, {3.814116440321191*^9, 3.814116471308749*^9}, {
   3.814116540461912*^9, 3.814116555354547*^9}, {3.814116586938077*^9, 
   3.814116587505672*^9}, {3.814117340348587*^9, 3.814117351091815*^9}, 
   3.814117394461707*^9, {3.8141175543220787`*^9, 3.814117554447184*^9}, {
   3.8141176017107973`*^9, 3.814117605709382*^9}, {3.8141176776547422`*^9, 
   3.8141176780595303`*^9}, {3.81481469421801*^9, 3.8148147394219*^9}, {
   3.814814816251137*^9, 3.814814816408934*^9}, {3.8148150352839127`*^9, 
   3.8148150382348423`*^9}, {3.814815141355844*^9, 3.814815149188818*^9}, {
   3.8148151856578283`*^9, 3.814815185826562*^9}, 3.81481521893335*^9, {
   3.814815430746736*^9, 3.8148154420837297`*^9}, 3.8148154802131844`*^9, {
   3.814815566703246*^9, 3.814815573075321*^9}, {3.81481658602171*^9, 
   3.814816604744535*^9}, 3.8148172782169847`*^9, {3.8148173237279*^9, 
   3.814817343115831*^9}, {3.8159415286601257`*^9, 3.815941547612451*^9}, {
   3.8159415973173733`*^9, 3.815941598376073*^9}, {3.815941636162353*^9, 
   3.8159416410366917`*^9}, {3.815941773255077*^9, 3.815941975555637*^9}, {
   3.8159420848898087`*^9, 3.815942085311535*^9}, 3.815945040715632*^9, {
   3.815945086378645*^9, 3.815945086466773*^9}, {3.8190411959078283`*^9, 
   3.819041275042839*^9}, {3.819041313026609*^9, 3.81904132747954*^9}, {
   3.819041371880273*^9, 3.819041372721076*^9}, {3.819041495881653*^9, 
   3.81904150722186*^9}, 3.8190415773876667`*^9, {3.819382404200993*^9, 
   3.8193825634070683`*^9}, {3.819414603476612*^9, 3.819414680103821*^9}, {
   3.819552448402487*^9, 3.8195525134451523`*^9}, {3.819552673572792*^9, 
   3.819552732337421*^9}, {3.819552995125099*^9, 3.8195530820376*^9}, 
   3.8195531653906927`*^9, {3.819553206737208*^9, 3.819553313988759*^9}, {
   3.819553404792535*^9, 3.819553418745451*^9}, {3.819553463248163*^9, 
   3.819553521688301*^9}, 3.819553585320606*^9, {3.819553618540432*^9, 
   3.819553664431827*^9}, 3.819553695161172*^9, 3.8195538564337053`*^9, 
   3.819554034353512*^9, {3.8195541663805923`*^9, 3.819554439437995*^9}, {
   3.819554490212126*^9, 3.8195545181850348`*^9}, {3.8195545518908253`*^9, 
   3.819554553615718*^9}, {3.81955462057576*^9, 3.819554627779599*^9}, {
   3.819554735147951*^9, 3.819554803421383*^9}, {3.819554845159384*^9, 
   3.819554845732935*^9}, {3.819555002950602*^9, 3.8195550604024153`*^9}, {
   3.8195550920538597`*^9, 3.8195551065682592`*^9}, {3.81955522557211*^9, 
   3.819555360858951*^9}, {3.819555418994678*^9, 3.819555485405669*^9}, {
   3.81967622251266*^9, 3.819676252268173*^9}, {3.819676507029765*^9, 
   3.81967650814923*^9}, {3.819677190306395*^9, 3.819677191251915*^9}, {
   3.819677234359509*^9, 3.819677235020162*^9}, {3.8196776032873087`*^9, 
   3.819677603373057*^9}, {3.8226664977233686`*^9, 3.8226665375610867`*^9}, {
   3.822666593027319*^9, 3.822666609957299*^9}, {3.822666687000177*^9, 
   3.8226667376585627`*^9}, {3.822666788963731*^9, 3.8226668897399054`*^9}, 
   3.822666935152439*^9, {3.8226670231965027`*^9, 3.822667046218884*^9}, 
   3.822667086254045*^9},
 CellLabel->
  "In[387]:=",ExpressionUUID->"beeee97c-e957-4b20-831e-63e7fe13b599"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Welcome to DMFormFactor version 1.1.\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->32,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.822666679997175*^9, 3.822666738146166*^9}, {
   3.8226668200085907`*^9, 3.8226668347747593`*^9}, {3.8226668705774803`*^9, 
   3.8226668900504847`*^9}, 3.822666939436062*^9, {3.8226670238548813`*^9, 
   3.822667046764731*^9}, 3.8226670869133863`*^9},
 CellLabel->
  "During evaluation of \
In[387]:=",ExpressionUUID->"09783dd3-0287-4e6b-be33-aa6a8fe07340"],

Cell[BoxData["\<\"Functions are SetCoeffsNonrel, SetCoeffsRel, SetCoeffsNucl, \
ZeroCoeffs, SetJChi, SetMchi, SetIsotope, SetHALO, SetHelm, \
TransitionProbability, ResponseNucl, DiffCrossSection, \
ApproxTotalCrossSection, and EventRate.\"\>"], "Print",
 CellChangeTimes->{{3.822666679997175*^9, 3.822666738146166*^9}, {
   3.8226668200085907`*^9, 3.8226668347747593`*^9}, {3.8226668705774803`*^9, 
   3.8226668900504847`*^9}, 3.822666939436062*^9, {3.8226670238548813`*^9, 
   3.822667046764731*^9}, 3.82266708691504*^9},
 CellLabel->
  "During evaluation of \
In[387]:=",ExpressionUUID->"3c26984b-daa3-4dec-a5d0-c1b9d6f06e14"],

Cell[BoxData["\<\"Getting default matrix...\"\>"], "Print",
 CellChangeTimes->{{3.822666679997175*^9, 3.822666738146166*^9}, {
   3.8226668200085907`*^9, 3.8226668347747593`*^9}, {3.8226668705774803`*^9, 
   3.8226668900504847`*^9}, 3.822666939436062*^9, {3.8226670238548813`*^9, 
   3.822667046764731*^9}, 3.822667086916482*^9},
 CellLabel->
  "During evaluation of \
In[387]:=",ExpressionUUID->"b11e51e3-40fd-4d65-947c-0a40921482e7"],

Cell[BoxData["\<\"Setting isotope to silicon-28.\"\>"], "Print",
 CellChangeTimes->{{3.822666679997175*^9, 3.822666738146166*^9}, {
   3.8226668200085907`*^9, 3.8226668347747593`*^9}, {3.8226668705774803`*^9, 
   3.8226668900504847`*^9}, 3.822666939436062*^9, {3.8226670238548813`*^9, 
   3.822667046764731*^9}, 3.8226670869173737`*^9},
 CellLabel->
  "During evaluation of \
In[387]:=",ExpressionUUID->"713d4282-2736-4385-853c-224beb069f6d"]
}, Open  ]],

Cell[BoxData[
 FractionBox["2.256570490428321`*^8", "GeV"]], "Output",
 CellChangeTimes->{{3.822666696570128*^9, 3.822666741308366*^9}, {
   3.822666823258338*^9, 3.822666837931415*^9}, {3.8226668737600594`*^9, 
   3.822666893221313*^9}, 3.8226669426578913`*^9, {3.822667026989747*^9, 
   3.822667050084248*^9}, 3.822667090825026*^9},
 CellLabel->
  "Out[416]=",ExpressionUUID->"89ef6cd7-f907-4941-85ff-c13a8171b546"]
}, Open  ]]
},
WindowSize->{1093, 1209},
WindowMargins->{{1, Automatic}, {Automatic, 24}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f85f4dac-cd0f-47aa-acb4-b04f34219865"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 12447, 263, 924, "Input",ExpressionUUID->"beeee97c-e957-4b20-831e-63e7fe13b599"],
Cell[CellGroupData[{
Cell[13052, 289, 672, 15, 49, "Print",ExpressionUUID->"09783dd3-0287-4e6b-be33-aa6a8fe07340"],
Cell[13727, 306, 629, 10, 44, "Print",ExpressionUUID->"3c26984b-daa3-4dec-a5d0-c1b9d6f06e14"],
Cell[14359, 318, 435, 7, 24, "Print",ExpressionUUID->"b11e51e3-40fd-4d65-947c-0a40921482e7"],
Cell[14797, 327, 442, 7, 24, "Print",ExpressionUUID->"713d4282-2736-4385-853c-224beb069f6d"]
}, Open  ]],
Cell[15254, 337, 417, 7, 77, "Output",ExpressionUUID->"89ef6cd7-f907-4941-85ff-c13a8171b546"]
}, Open  ]]
}
]
*)

