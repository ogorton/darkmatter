(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13915,        289]
NotebookOptionsPosition[     12659,        262]
NotebookOutlinePosition[     13052,        278]
CellTagsIndexPosition[     13009,        275]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", 
   RowBox[{
   "(", "\"\<~/data_500/sdsu/projects/darkmatter/mathematica/dmformfactor-V6.\
m\>\"", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dfilename", "=", "\"\<default\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "=", "14"}], ";", " ", 
  RowBox[{"m", "=", "28"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetIsotope", "[", 
   RowBox[{"z", ",", "m", ",", "\"\<default\>\"", ",", "dfilename"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetJChi", "[", 
   RowBox[{"1", "/", "2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetMChi", "[", 
   RowBox[{"50", "GeV"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoeffsNonrel", "[", 
   RowBox[{"5", ",", " ", "3.1", ",", "\"\<n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", "=", "3"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NT", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ve", "=", "232"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", "=", "220"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoDM", " ", "=", " ", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetHALO", "[", "\"\<MB\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"EventRate", "[", 
    RowBox[{"NT", ",", "rhoDM", ",", "q", ",", "ve", ",", "v0"}], "]"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.793490410067214*^9, 3.793490416320354*^9}, {
   3.793490601240102*^9, 3.7934906081070747`*^9}, {3.794183367590694*^9, 
   3.794183367706806*^9}, 3.79478124874539*^9, {3.7947813324086018`*^9, 
   3.794781338405695*^9}, {3.7953820336283407`*^9, 3.795382040136541*^9}, {
   3.795382741095727*^9, 3.7953827424648848`*^9}, {3.795382787804698*^9, 
   3.7953827879648657`*^9}, {3.795383161358199*^9, 3.7953831960618143`*^9}, {
   3.795383236975806*^9, 3.795383248308873*^9}, {3.7953849650724697`*^9, 
   3.795384971498005*^9}, {3.795387795395919*^9, 3.7953878232204533`*^9}, {
   3.7953878770685873`*^9, 3.79538788279907*^9}, {3.797189974839698*^9, 
   3.7971899749830437`*^9}, {3.797190058387877*^9, 3.7971900595172157`*^9}, {
   3.797190279376642*^9, 3.797190279432508*^9}, {3.797190440286759*^9, 
   3.797190522108032*^9}, {3.7971906976265163`*^9, 3.7971906998437433`*^9}, {
   3.7971907829972143`*^9, 3.7971907837306767`*^9}, {3.7979524030301113`*^9, 
   3.797952523340369*^9}, {3.797952564400098*^9, 3.7979525646207657`*^9}, {
   3.797952643478393*^9, 3.797952669200509*^9}, {3.797952976537588*^9, 
   3.797952978183794*^9}, {3.797955095802773*^9, 3.797955124894256*^9}, {
   3.797960965056282*^9, 3.79796096518362*^9}, {3.797962110404883*^9, 
   3.7979621194607477`*^9}, {3.798669377172854*^9, 3.7986693850683517`*^9}, {
   3.798669416570314*^9, 3.7986694220119658`*^9}, 3.798669461458296*^9, {
   3.798670905841943*^9, 3.7986709145634403`*^9}, {3.7989352664772377`*^9, 
   3.7989352790158367`*^9}, {3.798935633675097*^9, 3.7989356346802588`*^9}, {
   3.7989364398921556`*^9, 3.7989364401183023`*^9}, {3.79893699859452*^9, 
   3.798937018073009*^9}, {3.7989380247210093`*^9, 3.798938024964447*^9}, {
   3.798938099289225*^9, 3.79893811637171*^9}, {3.79893838594735*^9, 
   3.798938386625798*^9}, {3.7989407302091208`*^9, 3.798940731428252*^9}, {
   3.798991560074741*^9, 3.798991563826208*^9}, {3.798991856971097*^9, 
   3.79899185914869*^9}, {3.79899202402815*^9, 3.798992041855124*^9}, {
   3.798992107922368*^9, 3.7989921232298613`*^9}, {3.7989922549481773`*^9, 
   3.798992255365807*^9}, 3.798992498085147*^9, {3.7990079132367573`*^9, 
   3.799007915722193*^9}, {3.7990079794354*^9, 3.799008001241795*^9}, {
   3.799008052369609*^9, 3.799008054856303*^9}, {3.799008141659869*^9, 
   3.7990081448265343`*^9}, {3.799008441765174*^9, 3.7990084519529*^9}, 
   3.799011121038231*^9, {3.799011227027068*^9, 3.799011234488392*^9}, {
   3.79902405011126*^9, 3.799024052206958*^9}, {3.7990241419779987`*^9, 
   3.799024172049665*^9}, {3.7990243952950907`*^9, 3.799024429350996*^9}, {
   3.799024692538885*^9, 3.799024695131917*^9}, {3.799024758644464*^9, 
   3.7990247587202168`*^9}, {3.7990255882307453`*^9, 3.799025590768423*^9}, {
   3.799025716289378*^9, 3.799025716923978*^9}, {3.799169329819613*^9, 
   3.799169332251799*^9}, {3.799172217703122*^9, 3.799172220128579*^9}, {
   3.799592659637047*^9, 3.799592685040333*^9}, {3.79959298839711*^9, 
   3.7995930186994267`*^9}, {3.814116440321191*^9, 3.814116471308749*^9}, {
   3.814116540461912*^9, 3.814116555354547*^9}, {3.814116586938077*^9, 
   3.814116587505672*^9}, {3.814117340348587*^9, 3.814117351091815*^9}, 
   3.814117394461707*^9, {3.8141175543220787`*^9, 3.814117554447184*^9}, {
   3.8141176017107973`*^9, 3.814117605709382*^9}, {3.8141176776547422`*^9, 
   3.8141176780595303`*^9}},
 CellLabel->
  "In[926]:=",ExpressionUUID->"beeee97c-e957-4b20-831e-63e7fe13b599"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Welcome to DMFormFactor version 1.1.\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->32,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.814117378490899*^9, 3.814117395089156*^9}, 
   3.814117554792487*^9, 3.81411760608467*^9, 3.814117678681734*^9, 
   3.814129989335287*^9},
 CellLabel->
  "During evaluation of \
In[926]:=",ExpressionUUID->"40e1e8df-02c6-43a2-ae00-f175f56c8a68"],

Cell[BoxData["\<\"Functions are SetCoeffsNonrel, SetCoeffsRel, SetCoeffsNucl, \
ZeroCoeffs, SetJChi, SetMchi, SetIsotope, SetHALO, SetHelm, \
TransitionProbability, ResponseNucl, DiffCrossSection, \
ApproxTotalCrossSection, and EventRate.\"\>"], "Print",
 CellChangeTimes->{{3.814117378490899*^9, 3.814117395089156*^9}, 
   3.814117554792487*^9, 3.81411760608467*^9, 3.814117678681734*^9, 
   3.814129989337027*^9},
 CellLabel->
  "During evaluation of \
In[926]:=",ExpressionUUID->"1f68cd6f-0d34-4496-9a00-ecb19b690d9a"],

Cell[BoxData["\<\"Getting default matrix...\"\>"], "Print",
 CellChangeTimes->{{3.814117378490899*^9, 3.814117395089156*^9}, 
   3.814117554792487*^9, 3.81411760608467*^9, 3.814117678681734*^9, 
   3.8141299893383703`*^9},
 CellLabel->
  "During evaluation of \
In[926]:=",ExpressionUUID->"c001dffc-ba70-42b9-be7c-29f38645febb"],

Cell[BoxData["\<\"Setting isotope to silicon-28.\"\>"], "Print",
 CellChangeTimes->{{3.814117378490899*^9, 3.814117395089156*^9}, 
   3.814117554792487*^9, 3.81411760608467*^9, 3.814117678681734*^9, 
   3.814129989340205*^9},
 CellLabel->
  "During evaluation of \
In[926]:=",ExpressionUUID->"7cdb162c-e969-43ff-b055-6b4a2903e678"],

Cell[BoxData["\<\"Your Lagrangian is\"\>"], "Print",
 CellChangeTimes->{{3.814117378490899*^9, 3.814117395089156*^9}, 
   3.814117554792487*^9, 3.81411760608467*^9, 3.814117678681734*^9, 
   3.814129989341186*^9},
 CellLabel->
  "During evaluation of \
In[926]:=",ExpressionUUID->"39623dc2-2689-48ad-b180-5aaa805fa3d6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" \\!\\(\\*SubscriptBox[\\(L\\), \\(prot\\)]\\)=\"\>", 
   "\[InvisibleSpace]", "0.`"}],
  SequenceForm[" \!\(\*SubscriptBox[\(L\), \(prot\)]\)=", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{{3.814117378490899*^9, 3.814117395089156*^9}, 
   3.814117554792487*^9, 3.81411760608467*^9, 3.814117678681734*^9, 
   3.814129989342245*^9},
 CellLabel->
  "During evaluation of \
In[926]:=",ExpressionUUID->"671a227c-fb11-45d3-91b0-84769fe3e2cb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\" \\!\\(\\*SubscriptBox[\\(L\\), \\(neut\\)]\\)=\"\>", 
    "\[InvisibleSpace]", "0.`"}], "\[VeryThinSpace]", "+", 
   RowBox[{
   "0.000054507572408256263`", 
    " ", "\<\"\[ImaginaryI] \\!\\(\\*SubscriptBox[\\(S\\), \\(\[Chi]\\)]\\)\
\[CenterDot](q\[Times]\\!\\(\\*SuperscriptBox[\\(v\\), \
\\(\[Perpendicular]\\)]\\))\"\>"}]}],
  SequenceForm[
  " \!\(\*SubscriptBox[\(L\), \(neut\)]\)=", 0. + 
   0.000054507572408256263` 
    "\[ImaginaryI] \!\(\*SubscriptBox[\(S\), \(\[Chi]\)]\)\[CenterDot](q\
\[Times]\!\(\*SuperscriptBox[\(v\), \(\[Perpendicular]\)]\))"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.814117378490899*^9, 3.814117395089156*^9}, 
   3.814117554792487*^9, 3.81411760608467*^9, 3.814117678681734*^9, 
   3.814129989343358*^9},
 CellLabel->
  "During evaluation of \
In[926]:=",ExpressionUUID->"57047da6-5dc8-4580-a83c-b2ba9944ccff"],

Cell[BoxData["\<\"Your event rate is\"\>"], "Print",
 CellChangeTimes->{{3.814117378490899*^9, 3.814117395089156*^9}, 
   3.814117554792487*^9, 3.81411760608467*^9, 3.814117678681734*^9, 
   3.814129991903817*^9},
 CellLabel->
  "During evaluation of \
In[926]:=",ExpressionUUID->"57db2edb-144f-401a-a015-e9b1d47b4051"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.337854`", ",", "1.2169056347807141`*^-169"}], "}"}]], "Output",
 CellChangeTimes->{
  3.795378815655415*^9, 3.795378964134488*^9, 3.795379273552238*^9, 
   3.795379329894409*^9, {3.795381373991458*^9, 3.79538140187644*^9}, 
   3.795382051818445*^9, {3.7953827585240097`*^9, 3.795382789153632*^9}, 
   3.7953828511063623`*^9, {3.795383166206491*^9, 3.795383196305833*^9}, {
   3.795383239627536*^9, 3.795383248621126*^9}, 3.795384972137746*^9, 
   3.795385395427154*^9, 3.7953872712920933`*^9, 3.795387350891485*^9, {
   3.795387797824007*^9, 3.795387824657695*^9}, 3.795387883558316*^9, {
   3.797189971661209*^9, 3.797189980112216*^9}, 3.797190060002994*^9, 
   3.7971902810858192`*^9, {3.7971904946551943`*^9, 3.797190522454692*^9}, 
   3.797190700178143*^9, 3.797190784970533*^9, 3.797192333895232*^9, 
   3.7971928272446136`*^9, 3.797192901346627*^9, {3.797192993644742*^9, 
   3.7971930620256033`*^9}, {3.79719313269205*^9, 3.797193147242628*^9}, 
   3.7979504228652353`*^9, {3.797952487600665*^9, 3.7979525260172863`*^9}, 
   3.797952565545308*^9, {3.797952644197661*^9, 3.7979526699864063`*^9}, 
   3.7979529807633867`*^9, 3.797954858310628*^9, 3.797954889253489*^9, {
   3.7979550965909023`*^9, 3.797955125672391*^9}, 3.7979609680062113`*^9, {
   3.797962111015897*^9, 3.797962148685156*^9}, 3.797962361457348*^9, 
   3.797962395453519*^9, 3.7984086057497*^9, 3.79855783210795*^9, 
   3.79856105641709*^9, 3.798563366235579*^9, 3.7986694628565893`*^9, 
   3.7986696051336823`*^9, 3.798669640201926*^9, {3.79867027541761*^9, 
   3.798670298876418*^9}, 3.798670915398823*^9, 3.798897495916484*^9, 
   3.798897837282936*^9, 3.798903805573118*^9, {3.798903858128158*^9, 
   3.7989038978400908`*^9}, 3.798935298924197*^9, 3.798935635203268*^9, 
   3.798936440428461*^9, {3.798936999854149*^9, 3.798937019034801*^9}, {
   3.798938026062125*^9, 3.79893803904972*^9}, {3.7989381006958427`*^9, 
   3.7989381172724447`*^9}, {3.7989383876513853`*^9, 3.798938397810951*^9}, 
   3.798938669089492*^9, 3.798940731981468*^9, 3.7989889161594687`*^9, 
   3.798991574458305*^9, 3.798991860693266*^9, {3.798992029419363*^9, 
   3.7989920502242804`*^9}, 3.798992132221917*^9, 3.7989922642116213`*^9, 
   3.798992505983392*^9, 3.799007920322555*^9, {3.799007981950226*^9, 
   3.79900800199977*^9}, 3.799008056317338*^9, 3.799008153226143*^9, {
   3.7990084508362007`*^9, 3.799008474853715*^9}, 3.799011078255823*^9, 
   3.7990111229915047`*^9, 3.799011236207934*^9, 3.799015335886231*^9, 
   3.799024053476988*^9, {3.799024145714801*^9, 3.799024174056992*^9}, {
   3.7990244067916613`*^9, 3.799024437176838*^9}, 3.799024700803492*^9, 
   3.799024760982341*^9, 3.7990255968713818`*^9, 3.799025722972562*^9, 
   3.7990259402013187`*^9, 3.799169300966125*^9, 3.799169335169773*^9, 
   3.799172228384266*^9, 3.79958938887722*^9, 3.799592665244116*^9, {
   3.799592996012925*^9, 3.7995930203347397`*^9}, {3.814117376412862*^9, 
   3.814117396891203*^9}, 3.814117556690379*^9, 3.814117607888113*^9, 
   3.814117680473771*^9, 3.814129991905176*^9},
 CellLabel->
  "Out[940]=",ExpressionUUID->"57970983-c9c4-4572-b364-110659f6cac2"]
}, Open  ]]
},
WindowSize->{743, 934},
WindowMargins->{{0, Automatic}, {38, Automatic}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f85f4dac-cd0f-47aa-acb4-b04f34219865"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5052, 91, 367, "Input",ExpressionUUID->"beeee97c-e957-4b20-831e-63e7fe13b599"],
Cell[CellGroupData[{
Cell[5657, 117, 561, 14, 101, "Print",ExpressionUUID->"40e1e8df-02c6-43a2-ae00-f175f56c8a68"],
Cell[6221, 133, 521, 9, 63, "Print",ExpressionUUID->"1f68cd6f-0d34-4496-9a00-ecb19b690d9a"],
Cell[6745, 144, 328, 6, 24, "Print",ExpressionUUID->"c001dffc-ba70-42b9-be7c-29f38645febb"],
Cell[7076, 152, 331, 6, 24, "Print",ExpressionUUID->"7cdb162c-e969-43ff-b055-6b4a2903e678"],
Cell[7410, 160, 319, 6, 24, "Print",ExpressionUUID->"39623dc2-2689-48ad-b180-5aaa805fa3d6"],
Cell[7732, 168, 496, 11, 27, "Print",ExpressionUUID->"671a227c-fb11-45d3-91b0-84769fe3e2cb"],
Cell[8231, 181, 922, 21, 28, "Print",ExpressionUUID->"57047da6-5dc8-4580-a83c-b2ba9944ccff"],
Cell[9156, 204, 319, 6, 24, "Print",ExpressionUUID->"57db2edb-144f-401a-a015-e9b1d47b4051"]
}, Open  ]],
Cell[9490, 213, 3153, 46, 60, "Output",ExpressionUUID->"57970983-c9c4-4572-b364-110659f6cac2"]
}, Open  ]]
}
]
*)

